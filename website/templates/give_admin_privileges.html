{% extends "base.html" %}

{% block title %}Give Admin privileges{% endblock %}

{% block content %}
    <script>
        function checkEmail() {
            var email = document.getElementById('user_email').value;
            var email_list = {{email_list|safe}}
            if (email_list.includes(email)) {
                email_error.style.display = 'none';
                document.getElementById('give_admin').disabled = false;
                document.getElementById('remove_admin').disabled = false;
            } else {
                email_error.style.display = 'block';
                document.getElementById('give_admin').disabled = true;
                document.getElementById('remove_admin').disabled = true;
            }
        }

        function submitForm(action) {
            // Get the form element
            var form = document.getElementById('admin_form');
            
            // Set the action attribute based on the button clicked
            if (action === 'give_admin') {
                form.action = '/give_admin_privileges';
            } else if (action === 'remove_admin') {
                form.action = '/remove_admin_privileges';
                
            }
            
            // Submit the form
            form.submit();
        }
    </script>
    
    <form id="admin_form" method="post" action="/give_admin_privileges">
        <input type="text" name="user_email" id="user_email" placeholder="User email" oninput="checkEmail()"/>
        <input type="button" id="give_admin" value="Give admin" onclick="submitForm('give_admin')">
        <input type="button" id="remove_admin" value="Remove admin" onclick="submitForm('remove_admin')"><br>
        <span id="email_error" style="display: none">User email doesnt exist</span>
        <script> checkEmail(); </script>
    </form>


    <ul>
        {% for user in users %}
            <li>{{ user[0] }} - Admin={{ user[1] }}</li>
        {% endfor %}
    </ul>


    
{% endblock %}