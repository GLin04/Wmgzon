{% extends "base.html" %}
{% block title %}{{product[1]}}{% endblock %}

{% block css %}
<link href="../../static/css/home-styles.css" rel="stylesheet" />
{% endblock %}
{% block logo %}            
<div class="logo">
    <a href="/">
        <img src="../../static/images/wmgzon.png">
    </a>
</div>
{% endblock %}
{% block content %}
<div class="product-page">
    <div class="product-details">
        <h1>{{product[1]}}</h1>
        <img src="{{ url_for('static', filename='images/' + product[10]) }}" width="300" height="300"/>
        <p>{{product[2]}} left!</p>
        <p>Category: {{product[3]}}</p>
        <p>Price: £{{product[4]}}</p>
        <p>{{product[5]}} day delivery </p>
        <p>Brand: {{product[6]}}</p>
        <p>Specification: {{product[7]}}</p>
        <p>Description: {{product[8]}}</p>


        <form id="add_to_basket_form" action='/add_to_basket' method="post">
            <input type="hidden" id="product_id" name="product_id" value="{{product[0]}}">
            <label for="quantity">Quantity:</label>
            <input type="number" id="quantity" name="quantity" value="1" placeholder="Quantity" oninput="calculateTotal()"/><br>
                <p>Professional installation (+£40)
                    <input id="prof_installation" type="checkbox" name="prof_installation" oninput="calculateTotal()" >
                </p>

                <input type="hidden" id="prof_installation_hidden" name="prof_installation_hidden">          
                <input type="submit" value="Add to Cart"></input>
                <input type="hidden" id="total_hidden" name="total_hidden" value="0.0">
                <span id="total">TOTAL = £{{product[4]}}</span>
        </form>
        <div id="go_to_basket_div">
            <span>Product already in basket</span>
            <input type="button" value="Go to Basket" onclick="window.location.href='/basket'"></input>
        </div>

        <script>
            var price = {{product[4]}};
            var product_id = {{product[0]}};
            
            document.addEventListener("DOMContentLoaded", function(event) {
                calculateTotal();
            });
        </script>
        <script>

            const add_to_basket_form = document.getElementById('add_to_basket_form');
            const go_to_basket_div = document.getElementById('go_to_basket_div');

            go_to_basket_div.style.display = "none";
            
            if ({{product_ids}}.includes({{product[0]}})) {
                add_to_basket_form.style.display = "none";
                go_to_basket_div.style.display = "block";
            }  

        </script>
    </div>
</div>
{% endblock %}

{% block js %}
<script src=../../static/js/product-management.js></script>       
{% endblock %}
